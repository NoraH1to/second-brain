---
title: å‘å¸ƒ
date created: 2023-06-10
date modified: 2023-06-11
---

## [[jekyll]] æ–¹æ¡ˆ

æ— æ„é—´çœ‹åˆ°çš„æ•™ç¨‹[obsidian ç›®å‰æœ€å®Œç¾çš„å…è´¹å‘å¸ƒæ–¹æ¡ˆ - æ¸è¿›å¼æ•™ç¨‹ â€” ğŸŒ± oldwinterã®æ•°å­—èŠ±å›­](https://notes.oldwinter.top/obsidian-%E7%9B%AE%E5%89%8D%E6%9C%80%E5%AE%8C%E7%BE%8E%E7%9A%84%E5%85%8D%E8%B4%B9%E5%8F%91%E5%B8%83%E6%96%B9%E6%A1%88-%E6%B8%90%E8%BF%9B%E5%BC%8F%E6%95%99%E7%A8%8B)

éƒ¨ç½²è¿‡ç¨‹ä¸­å‡ ä¹æ²¡å‘ï¼Œå°±ç®—æ˜¯å°ç™½ä¹Ÿèƒ½å¤§æ¦‚è·‘é€šï¼Œéœ€è¦[[é…ç½®Rubyç¯å¢ƒ]]

## [[Hugo]] æ–¹æ¡ˆ

å‘æ¯”è¾ƒå¤šï¼Œä½†æ˜¯éƒ¨ç½²åæ•ˆæœæ¯”[[#jekyll æ–¹æ¡ˆ]]å¥½ä¸Šä¸å°‘ï¼Œä¾‹å¦‚æ·±è‰²æ¨¡å¼ã€å…¨å±€æ£€ç´¢

### å®‰è£…

fork ä¸€ä»½[jackyzha0/quartz](https://github.com/jackyzha0/quartz)ï¼Œä½¿ç”¨ `git clone` æ‹‰åˆ°æœ¬åœ°ï¼Œè¿›å…¥è¯¥é¡¹ç›®çš„ç›®å½•

åˆ é™¤æ•´ä¸ª `content` æ–‡ä»¶å¤¹ï¼Œå°†[[Obsidian]]å·¥ä½œåŒºå…³è”åˆ° `content` æ–‡ä»¶å¤¹ï¼Œæ ¹æ®åŒæ­¥æ–¹æ¡ˆæ–¹å¼æœ‰æ‰€ä¸åŒï¼š
- [[Git]]åŒæ­¥ï¼šå°†å·¥ä½œåŒºä»“åº“æ·»åŠ ä¸ºå­æ¨¡å— `git submodule add ä»“åº“åœ°å€ content`
- å…¶å®ƒæ–¹æ¡ˆï¼šç›´æ¥å°†æ•´ä¸ªå·¥ä½œåŒºçš„å†…å®¹å¤åˆ¶åˆ° `content` æ–‡ä»¶å¤¹ä¸­å³å¯

### é¢„è§ˆ

å¦‚æœéœ€è¦æœ¬åœ°é¢„è§ˆéƒ¨ç½²åçš„æ•ˆæœï¼Œé¦–å…ˆéœ€è¦[[Golang]]ç‰ˆæœ¬ `>= 1.16`ï¼Œå…¶æ¬¡éœ€è¦[å®‰è£…Hugo]([Installation | Hugo (gohugo.io)](https://gohugo.io/installation/))å’Œ hugo-obsidian
åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ‰§è¡Œ `go install github.com/jackyzha0/hugo-obsidian@latest` å³å¯å®Œæˆ hugo-obsidian çš„å®‰è£…

æœ€ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ‰§è¡Œ `make serve` æ¥å¯åŠ¨å¼€å‘æœåŠ¡ï¼Œé»˜è®¤ç«¯å£ä¸º `1313`ï¼Œå…·ä½“çœ‹å‘½ä»¤è¡Œè¾“å‡º

> [!INFO] make å‘½ä»¤
>
> åœ¨[[Windows]]ä¸‹éœ€è¦[[å®‰è£…mingw]]æ¥æ”¯æŒ `make` å‘½ä»¤

### é…ç½®

ç»å¤§éƒ¨åˆ†é…ç½®éƒ½åœ¨ `data/config.yaml` ä¸­ä¿®æ”¹ï¼Œè¯¥æ–‡ä»¶ä¸­çš„å†…å®¹ç…§çŒ«ç”»è™å°†ä½œè€…çš„ä¿¡æ¯æ›¿æ¢æˆè‡ªå·±çš„å³å¯
```yaml
name: NoraH1to # ä½œè€…åç§°
enableToc: true
openToc: false
enableLinkPreview: true
enableLatex: true
enableCodeBlockTitle: true
enableCodeBlockCopy: true
enableCallouts: true
enableSPA: true
enableFooter: true
enableContextualBacklinks: true
enableRecentNotes: true # æ˜¯å¦åœ¨ä¸»é¡µå±•ç¤ºæœ€è¿‘æ›´æ–°çš„æ–‡ç« 
enableGitHubEdit: false
enableMermaid: true
GitHubLink: https://github.com/NoraH1to/digital-garden-quartz/tree/hugo/content # ä»“åº“åœ°å€
search:
  enableSemanticSearch: false
  operandApiKey: "REPLACE-WITH-YOUR-OPERAND-API-KEY"
  operandIndexId: "REPLACE-WITH-YOUR-OPERAND-INDEX-ID"
description:
  æˆ‘çš„ç¬¬äºŒå¤§è„‘ï¼Œç”± obsidian é©±åŠ¨ã€‚ # ç«™ç‚¹æè¿°
page_title: "ğŸ§  ç¼¸ä¸­å¤§è„‘" # ä¸»é¡µæ ‡é¢˜
links: # é¡µè„šçš„ä¸€äº›è·³è½¬é“¾æ¥
  - link_name: GitHub
    link: https://github.com/NoraH1to

```

æ¯”è¾ƒé‡è¦çš„é…ç½®åœ¨ `config.toml` ä¸­
```toml
baseURL = "https://garden.norah1to.com/" # éƒ¨ç½²åŸºç¡€è·¯å¾„ï¼Œå¿…é¡»å¡«å¯¹
languageCode = "zh-cn" # æ²¡æœ‰ä½œç”¨
defaultContentLanguage = "zh-cn" # é»˜è®¤è¯­è¨€æ˜¯è‹±æ–‡ï¼Œè¿™è¡Œé…ç½®ä½œè€…æ²¡ç»™ï¼ŒæŸ¥äº† hugo æ–‡æ¡£è‡ªå·±æ·»åŠ ä¸Šçš„
relativeURLs = false
disablePathToLower = true
ignoreFiles = [] # å¿½ç•¥çš„æ–‡ä»¶ï¼Œéœ€è¦æ ¹æ® obsidian å®é™…æƒ…å†µæ¥ä¿®æ”¹ï¼Œæˆ‘ç•™ç©º
summaryLength = 20
paginate = 10
enableGitInfo = true

[markup]
    [markup.tableOfContents]
        endLevel = 3
        ordered = true
        startLevel = 2
    [markup.highlight]
        noClasses = false
        anchorLineNos = false
        codeFences = true
        guessSyntax = true
        hl_Lines = ""
        lineAnchors = ""
        lineNoStart = 1
        lineNos = true
        lineNumbersInTable = true
        style = "dracula"
    [frontmatter]
        lastmod = ["date modified", "lastmod", ":git", "date", "publishDate"] # å†³å®šç”¨ format yaml ä¸­çš„å“ªä¸ªå­—æ®µæ¥å±•ç¤ºæœ€åä¿®æ”¹æ—¶é—´
        publishDate = ["date created", "publishDate", "date"] # åŒä¸Šï¼Œä¸è¿‡æ˜¯å‘å¸ƒï¼ˆåˆ›å»ºï¼‰æ—¥æœŸ
    [markup.goldmark.renderer]
        unsafe = true

```

æœ€è¿‘æ›´æ–°çš„æ–‡ç« åœ¨å±•ç¤ºæ—¶ï¼Œé»˜è®¤åªå±•ç¤º 3 ç¯‡ï¼Œå¯ä»¥åœ¨ `layouts\partials\recent.html` ä¸­ä¿®æ”¹
```html
<div class="content-list">
  <h2>{{ i18n "recent_notes" }}</h2>
  {{$notes := .Site.RegularPages.ByLastmod.Reverse}}
  <!-- æ”¹æˆ 6 ç¯‡ -->
  {{partial "page-list.html" (first 6 $notes)}}
</div>
```

### å‘å¸ƒ

ä½¿ç”¨[[vercel]]æ‰˜ç®¡ï¼Œè¿™é‡Œå‘è¾ƒå¤š

[[vercel]]éƒ¨ç½²[[Hugo]]æ—¶é»˜è®¤ç‰ˆæœ¬ä¸º `0.58` ï¼Œéå¸¸æ—§ï¼Œç›¸å¯¹çš„æœ¬åœ°çš„ç‰ˆæœ¬æ˜¯ `0.113` 
è¿™é‡Œéœ€è¦åœ¨ `vercel.json` ä¸­é…ç½®ç¯å¢ƒå˜é‡ `HUGO_VERSION` æŒ‡å®šç‰ˆæœ¬
> [!INFO] æŒ‡å®šç‰ˆæœ¬
> æ–‡æ¡£è—çš„å¾ˆæ·±[Deployment Environments | Vercel Docs](https://vercel.com/docs/concepts/deployments/environments#specifying-framework-versions)
```json
// vercel.json
{
  "build": {
    "env": {
      "HUGO_VERSION": "0.113.0"
    }
  }
}
```

è¯¥æ–¹æ¡ˆçš„ä½œè€…ç‰¹åœ°å†™äº†ä¸€ä¸ªæ’ä»¶[jackyzha0/hugo-obsidian](https://github.com/jackyzha0/hugo-obsidian)æ¥ç”ŸæˆåŒå‘é“¾æ¥ï¼Œè¯¥æ’ä»¶éœ€è¦[[Golang]]ç¯å¢ƒæ‰èƒ½å®‰è£…
[[vercel]]å¹¶æ²¡æœ‰æä¾›è¯¥ç¯å¢ƒï¼Œè¿™é‡Œéœ€è¦å®šåˆ¶[buildCommand](https://vercel.com/docs/concepts/projects/project-configuration#buildcommand)æ¥æ‰‹åŠ¨å®‰è£…ç¯å¢ƒç„¶åæ‰“åŒ…
```json
// vercel.json
{
  "buildCommand": "sh ./flat.sh && curl -L https://git.io/vQhTU | bash -s -- --version 1.20.5 &&  source /vercel/.bashrc && go install github.com/jackyzha0/hugo-obsidian@latest && hugo-obsidian -input=content -output=assets/indices -index -root=. && ls && hugo --minify",
  "build": {
    "env": {
      "HUGO_VERSION": "0.113.0"
    }
  }
}
```

è¿™ä¸€å¤§å¨å‘½ä»¤æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š

- æ‹å¹³æ–‡ç« ï¼Œæ‰§è¡Œ `sh ./flat.sh`
	```sh
	#!/bin/bash
	mv content/*/*/*.md content/
	mv content/Home.md content/_index.md # å°† Home è®¾ç½®ä¸ºä¸»é¡µ
	```
- ä½¿ç”¨[canha/golang-tools-install-script](https://github.com/canha/golang-tools-install-script)å®‰è£…[[Golang]]ç¯å¢ƒ
	```bash
	curl -L https://git.io/vQhTU | bash -s -- --version 1.20.5
	source /vercel/.bashrc # æ›´æ–°ç¯å¢ƒå˜é‡
	```
- å®‰è£…[jackyzha0/hugo-obsidian](https://github.com/jackyzha0/hugo-obsidian)å¹¶ç”ŸæˆåŒå‘é“¾æ¥
	```bash
	go install github.com/jackyzha0/hugo-obsidian@latest
	hugo-obsidian -input=content -output=assets/indices
	```
- ä½¿ç”¨[[Hugo]]ç”Ÿæˆé™æ€ç«™ç‚¹
	```bash
	hugo --minify
	```

### ç¼–å†™æ–‡ç« 

> [!WARNING] æ ‡ç­¾
> åœ¨ç»™æ–‡ç« çš„[[Formatter]]ä¸­ä¸Šæ ‡ç­¾æ—¶ï¼Œ==**æ ‡ç­¾å¿…é¡»ä¸ºæ•°ç»„**==
> 
> å¦‚æœä½ åƒè¿™æ ·å†™æ ‡ç­¾
> ```yaml
> ---
> tags: æ ‡ç­¾A, æ ‡ç­¾B
> ---
> ```
> [[Obsidian]]å¯ä»¥è¯†åˆ«ï¼Œä½†æ˜¯è¯¥éƒ¨ç½²æ–¹æ¡ˆçš„è§£æå™¨ä¸èƒ½è¯†åˆ«åˆ°ï¼Œå…¶å†…éƒ¨å®ç°ä¸º
> ```go
> type Front struct {
> 	Title string   `yaml:"title"`
> 	Draft bool     `yaml:"draft"`
> 	Tags  []string `yaml:"tags"`
> }
> // è§£æ formatter
> raw_body, err := frontmatter.Parse(strings.NewReader(text), &matter, formats...)
> // å¦‚æœæŠ¥é”™äº†
> if err != nil {
> 	matter = Front{
> 		Title: "Untitled Page",
> 		Draft: false,
> 		Tags:  []string{},
> 	}
> }
> ```


æå®š

## åŒæ­¥å­ä»“åº“

å¦‚æœä½¿ç”¨äº†[[Git å­æ¨¡å—]]æ¥å…³è”[[Obsidian]]å·¥ä½œåŒºï¼Œæ­¤æ—¶éœ€è¦å®šæ—¶æ‹‰å–å­æ¨¡å—ä»“åº“çš„ä»£ç åˆ°å‘å¸ƒä»“åº“ä¸­ï¼Œè¿™é‡Œç›´æ¥é€šè¿‡[[Github Action]]æ¥è§£å†³
```yml
name: 'Submodules Sync'

on:
  schedule:
    - cron: '0 2 * * *'
  # Allows you to run this workflow manually from the Actions tab or through HTTP API
  workflow_dispatch:

jobs:
  sync:
    name: 'Submodules Sync'
    runs-on: ubuntu-latest

    # Use the Bash shell regardless whether the GitHub Actions runner is ubuntu-latest, macos-latest, or windows-latest
    defaults:
      run:
        shell: bash

    steps:
      # Checkout the repository to the GitHub Actions runner
      - name: Checkout
        uses: actions/checkout@v2
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          submodules: true

      # Update references
      - name: Git Sumbodule Update
        run: |
          git pull --recurse-submodules
          git submodule update --remote --recursive

      - name: Commit update
        run: |
          git config --global user.name 'Git bot'
          git config --global user.email 'bot@noreply.github.com'
          git remote set-url origin https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}
          git commit -am "Auto updated submodule references" && git push || echo "No changes to commit"
```

éœ€è¦ç»™äºˆ[[Github Action]]è¯»å†™æƒé™ï¼Œå¦åˆ™è¯¥å·¥ä½œæµå°†æ— æ³•åŒæ­¥å­ä»“åº“
![](https://vercel-proxy.norah1to.com/proxy/raw.githubusercontent.com/NoraH1to/cdn/master/img/20230611183221.png)